
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/> 
<title>JUMPDatabase: Basic Uses</title> 
<link href="search/search.css" rel="stylesheet" type="text/css"/> 
<script type="text/javascript" src="search/search.js"></script> 
<link href="navtree.css" rel="stylesheet" type="text/css"/> 
<script type="text/javascript" src="jquery.js"></script> 
<script type="text/javascript" src="navtree.js"></script> 
<script type="text/javascript" src="resize.js"></script> 
<script type="text/javascript"> 
$(document).ready(initResizable);
</script> 
<link href="doxygen.css" rel="stylesheet" type="text/css"/> 
</head> 
<body onload='searchBox.OnSelectItem(0);'> 
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script> 
<div id="top"> 
<div id="titlearea"> 
<div class='main_header'><div class="logo_seqoy"></div></div>
</div> 

<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('basic_uses.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<h1>Basic Uses </h1>  </div>
</div>
<div class="contents">
<div class="textblock"><p>This page show some basic examples of usage for the <b>JUMP Database Module</b>.<br/>
 <br/>
 On our examples we presume that you have your Core Data models created. See <a href="http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/CoreData/cdProgrammingGuide.html">Introduction to Core Data Programming Guide</a> <br/>
 to learn more about it.<br/>
 <br/>
</p>
<h2><a class="anchor" id="init_manager"></a>
Initializing the Database Manager</h2>
<p>The first step to start to work with the <a class="el" href="interface_j_p_d_b_manager.html">Database Manager</a> is initialize the all system. </p>
<div class="fragment"><pre class="fragment"> [[<a class="code" href="interface_j_p_d_b_manager_singleton.html" title="Singleton instance of Database Manager that handle the Core Data Environment.">JPDBManagerSingleton</a> <a class="code" href="interface_j_p_d_b_manager_singleton.html#a505d4d641b1b0adc616c6aba8c11951c" title="Init Singleton Class Instance.">sharedInstance</a>] <a class="code" href="interface_j_p_d_b_manager.html#aef389466245327a533a7881fd2d54c52" title="Start Core Data Databases.">startCoreData</a>];
</pre></div><p> The above code perform a lot of tasks. He initiate the full Core Data model and create the persistent stores if needed. We're using an <b>Singleton Instance</b> of the Manager. You always can initiate one regular instance, but in the most common cases you will use this way.</p>
<h2><a class="anchor" id="db_action"></a>
Performing Database Actions</h2>
<p>Database operations isn't called directy to the manager. Instead we create one instance of the <a class="el" href="interface_j_p_d_b_manager_action.html" title="Database Manager Action pack all data and settings to perform some database operation.">JPDBManagerAction</a> class, configure the data and settings to perform some <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> operation and finally run this action. Yes, looks like a lot of work, but actually is not. Let's see some examples: </p>
<div class="fragment"><pre class="fragment"> <span class="keywordtype">id</span> newRecord = [JPDatabaseManager createNewRecordForEntity:<span class="stringliteral">@&quot;MyEntity&quot;</span>];
</pre></div><p> This is was really simple, isn't? Let's see this same operation on a more custom fashion: </p>
<div class="fragment"><pre class="fragment"> <a class="code" href="interface_j_p_d_b_manager_action.html" title="Database Manager Action pack all data and settings to perform some database operation.">JPDBManagerAction</a> *anAction = [[<a class="code" href="interface_j_p_d_b_manager_singleton.html" title="Singleton instance of Database Manager that handle the Core Data Environment.">JPDBManagerSingleton</a> <a class="code" href="interface_j_p_d_b_manager_singleton.html#a505d4d641b1b0adc616c6aba8c11951c" title="Init Singleton Class Instance.">sharedInstance</a>] <a class="code" href="interface_j_p_d_b_manager.html#a9eb7b1ed5ff3667b54a35a8d315cf689" title="Helper method to retrieve an Database Action object.">getDatabaseAction</a>];
 [anAction setCommitTransaction:YES];
 <span class="keywordtype">id</span> newRecord = [anAction createNewRecordForEntity:<span class="stringliteral">@&quot;MyEntity&quot;</span>];
</pre></div><p> Well this looks a litle bit more complicated. Let's understand this two processes: The first one uses the <b>JPDatabaseManager</b> convenient macro shortcut that returns an <a class="el" href="interface_j_p_d_b_manager_action.html" title="Database Manager Action pack all data and settings to perform some database operation.">JPDBManagerAction</a> instance and perform this method in only one pass, is pure convenience. This macro is declared in the <a class="el" href="_j_p_d_b_manager_definitions_8h_source.html">JPDBManagerDefinitions.h</a> file. <br/>
 <br/>
 The second way needs more steps, but you should use that way when you need more control of the all process, for example, you can configure if you want to automatically commit the operation or create some more dinamically code on your database operations. <br/>
 </p>
<h2><a class="anchor" id="commit_operation"></a>
Commiting operations</h2>
<p><b>Core Data</b> never perform operations directly to the <b>Persistent Store</b>. It maintains one memory model and you need to save (commit) your changes. You can configure the <b>Database Manager</b> to automatically commit every operation as default and also you can configure each <b>Database Action</b> case by case. </p>
<div class="fragment"><pre class="fragment"> [[<a class="code" href="interface_j_p_d_b_manager_singleton.html" title="Singleton instance of Database Manager that handle the Core Data Environment.">JPDBManagerSingleton</a> <a class="code" href="interface_j_p_d_b_manager_singleton.html#a505d4d641b1b0adc616c6aba8c11951c" title="Init Singleton Class Instance.">sharedInstance</a>] setAutomaticallyCommit:YES];
</pre></div><p> Now all <b>Database Action</b> will be committed immediattelly. This is means that every <b>Database Action</b> instance returned by the <b>getDatabaseAction:</b> method will be configured with this setting. Now you can use the approach showed in the <a class="el" href="basic_uses.html#db_action">Performing Database Actions</a> section to configure some specific action with different setting.<br/>
 <br/>
 To manually commit all pending operations to the <b>Persistent Store</b> is very simple: </p>
<div class="fragment"><pre class="fragment"> [[<a class="code" href="interface_j_p_d_b_manager_singleton.html" title="Singleton instance of Database Manager that handle the Core Data Environment.">JPDBManagerSingleton</a> <a class="code" href="interface_j_p_d_b_manager_singleton.html#a505d4d641b1b0adc616c6aba8c11951c" title="Init Singleton Class Instance.">sharedInstance</a>] <a class="code" href="interface_j_p_d_b_manager.html#ada5bce4a83f780c43da549468e1872dd" title="Commit al pendent operations to the persistent store.">commit</a>];
</pre></div><p> If fore some reason the commit operation fails one <b>NSNotificaton</b> is posted. See <a class="el" href="errors.html">Handling Errors</a> for more inforation.</p>
<h2><a class="anchor" id="query_operation"></a>
Querying Database</h2>
<p>You will enconter a huge number of convenient methods to perform simple and very complex queries to the database. See <a class="el" href="queries.html">Performing Queries</a> for more information. Here are some examples of some query operations: </p>
<div class="fragment"><pre class="fragment"> <span class="comment">// Query all data from &#39;MyEntity&#39;.</span>
 NSArray *allData = [JPDatabaseManager queryAllDataFromEntity:<span class="stringliteral">@&quot;MyEntity&quot;</span>];
 
 <span class="comment">// Query data using the &#39;MyFilter&quot; Fetch Template and ordering by &#39;id&#39;.</span>
 NSArray *allData = [JPDatabaseManager queryEntity:<span class="stringliteral">@&quot;MyEntity&quot;</span> withFetchTemplate:<span class="stringliteral">@&quot;MyFilter&quot;</span> orderWithKey:<span class="stringliteral">@&quot;id&quot;</span>];
</pre></div><p> You can also mount your <b>Database Actions</b> on a more custom fashion: </p>
<div class="fragment"><pre class="fragment"> <a class="code" href="interface_j_p_d_b_manager_action.html" title="Database Manager Action pack all data and settings to perform some database operation.">JPDBManagerAction</a> *anAction = [[<a class="code" href="interface_j_p_d_b_manager_singleton.html" title="Singleton instance of Database Manager that handle the Core Data Environment.">JPDBManagerSingleton</a> <a class="code" href="interface_j_p_d_b_manager_singleton.html#a505d4d641b1b0adc616c6aba8c11951c" title="Init Singleton Class Instance.">sharedInstance</a>] <a class="code" href="interface_j_p_d_b_manager.html#a9eb7b1ed5ff3667b54a35a8d315cf689" title="Helper method to retrieve an Database Action object.">getDatabaseAction</a>];
 
 <span class="comment">// Apply the Entity.</span>
 [anAction applyEntity:<span class="stringliteral">@&quot;MyEntity&quot;</span>];
 
 <span class="comment">// Limit to 20 rows.</span>
 [anAction setStartFetchInLine:0 setLimitFetchResults:20];
 
 <span class="comment">// Order by &#39;name&#39; in desceding order.</span>
 [[anAction applyOrderKey:<span class="stringliteral">@&quot;id&quot;</span>] setAscendingOrder:NO];
 
 <span class="comment">// Perform the action.</span>
 NSArray *first20rows = [anAction runAction];
</pre></div><p> There you go, the <b>Database Action</b> is very flexible to configure and also very convenient to use. Note that all <b>apply...</b> methods return the <b>self</b> instance. So you can nest many apply methods on the same line.<br/>
 <br/>
 </p>
</div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="main.html">JUMP Database Programming Guide</a>      </li>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Properties</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath"> 
    <ul> 
      <li class="footer"><div class="copyright">
      		Copyright © 2011, <a href="http://seqoy.com">SEQOY.org</a> and <a href="http://pauloliveira.net/resume">Paulo Oliveira</a>. Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License Version 2.0</a>. Documentation by <a href="http://www.doxygen.org">Doxygen</a>. 
      	</div>
      </li> 
    </ul> 
  </div>
